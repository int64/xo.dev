<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>XO game</title>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:800,700,600,400' rel='stylesheet' type='text/css'>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
	<script>
	function c(){
		console.log.apply(console,arguments);
	}
	function getRandomInt(min, max) {
		return Math.floor(Math.random() * (max - min + 1)) + min;
	}
	function getRandomColor(){
		var color = '#';
		var hex = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'];
		for (var i = 0; i < 6; i++) {
			color += hex[getRandomInt(0,15)];
		}
		return color;
	}

	var game = {
		current: 'x',
		size: 5,
		winCount: 3,
		field: [],
		init: function(container) {
			for (var i = 0; i < game.size; i++) {
				var row = $('<div>').addClass('row');
				var gRow = [];
				for (var j = 0; j < game.size; j++) {
					row.append($('<div>').addClass('cell'));
					gRow.push(null);
				}
				container.append(row);
				game.field.push(gRow);
			}
			container.css({'width': game.size * 80 + 'px'});
		},
		setCell: function(x,y) {
			var sign = game.current;
			if (game.field[x][y] != null) {
				return false;
			}
			game.field[x][y] = game.current;
			game.current = game.current == 'x' ? 'o' : 'x';
			return sign;
		},
		/*oldCheckWin: function(sign) {
			for (var i = 0; i < 3; i++) {
				// check horizontal
				if (game.field[i][0] == sign && game.field[i][1] == sign && game.field[i][2] == sign) {
					return true;
				}
				// check vertical
				if (game.field[0][i] == sign && game.field[1][i] == sign && game.field[2][i] == sign) {
					return true;
				}
				// check diagonal topleft
				if (i == 0 && game.field[i][i] == sign && game.field[i+1][i+1] == sign && game.field[i+2][i+2] == sign) {
					return true;
				}
				// check diagonal topright
				if (i == 0 && game.field[i][i+2] == sign && game.field[i+1][i+1] == sign && game.field[i+2][i] == sign) {
					return true;
				}
			}
			return false;
		},*/
		checkWin: function(sign) {
			var v = 0;
			var h = 0;
			for (var i = 0; i < game.size; i++) {
				for (var j = 0; j < game.size; j++) {
					if (game.field[i][j] == sign) {
						h++;
					} else {
						h = 0;
					}
					if (h == game.winCount) {
						return 'h';
					}
					if (game.field[j][i] == sign) {
						v++;
					} else {
						v = 0;
					}
					if (v == game.winCount) {
						return 'v';
					}
				}
			}
			return false;
		}
	}

	$(function(){
		game.init($('#field'));
		$('.cell').on('click',function(){
			var x = $(this).parent().index('.row');
			var y = $(this).index('.row:eq(' + x + ') .cell');
			var sign = game.setCell(x,y);
			c('sign: ',sign);
			if (sign) {
				$(this).addClass(sign);
				c('checkWin: ',game.checkWin(sign));
			}
		});
	})
	</script>
	<style>
	* {
		margin: 0;
		padding: 0;
	}
	#field {
		margin: 0 auto;
		position: relative;
		width: 255px;
	}
	.row {
		height: 80px;
	}
	.cell {
		box-sizing: border-box;
		border: 1px solid gray;
		display: inline-block;
		height: 80px;
		position: relative;
		width: 80px;
	}
	.row:first-child .cell {
		border-top: 0;
	}
	.row:last-child .cell {
		border-bottom: 0;
	}
	.row .cell:first-child {
		border-left: 0;
	}
	.row .cell:last-child {
		border-right: 0;
	}
	.cell.x:after, .cell.o:after {
		font-family: 'Open Sans';
		font-size: 70px;
		font-weight: bold;
		height: 80px;
		left: 0;
		line-height: 1;
		position: absolute;
		text-align: center;
		top: 0;
		width: 80px;
	}
	.cell.x:after {
		content: 'x';
	}
	.cell.o:after {
		content: 'o';
	}
	</style>
</head>
<body>
	<div id="field"></div>
</body>
</html>